#!/bin/sh
# Wrapper around xulrunner-stub to start the xulrunner application conkeror
# Written by Axel Beckert <abe@deuxchevaux.org> for the Debian Project

# Find an appropriate xulrunner-stub binary
XULRUNNER=''
for xr in xulrunner-stub-1.9.1 xulrunner-stub-1.9 xulrunner; do
    XRTMP=`readlink -m /usr/share/conkeror/$xr`
    if [ -n "$XRTMP" -a -x "$XRTMP" ]; then
	XULRUNNER=/usr/share/conkeror/$xr
    fi
done

if [ -z "$XULRUNNER" ]; then
    echo "No xulrunner found. (Unsatisfied package dependencies?) Bailing out." 1>&2
    exit 1;
fi

if [ "$*" = "--help" ]; then
    errormsg="`exec $XULRUNNER \"$@\" 2>&1`"
    echo "$errormsg" | sed -e "s:/[^ ]*/xulrunner-stub[^ ]*:$0:; /-\(width\|height\)/d" 1>&2
else
    exec $XULRUNNER "$@"
fi
